Updated git hooks.
Git LFS initialized.
Looking in indexes: https://mirrors.aliyun.com/pypi/simple
Requirement already satisfied: numpy in /root/.local/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 1)) (1.19.5)
Requirement already satisfied: transformers in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 2)) (4.10.2)
Requirement already satisfied: sentencepiece in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 3)) (0.1.96)
Requirement already satisfied: datasets in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 4)) (1.12.1)
Requirement already satisfied: scikit-learn in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 5)) (1.0.1)
Requirement already satisfied: boto3 in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 6)) (1.20.5)
Requirement already satisfied: wikiextractor in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 7)) (3.0.6)
Requirement already satisfied: nltk in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 8)) (3.6.5)
Requirement already satisfied: pyter3==0.3 in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 9)) (0.3)
Requirement already satisfied: razdel==0.5.0 in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 10)) (0.5.0)
Requirement already satisfied: tabulate==0.8.7 in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 11)) (0.8.7)
Requirement already satisfied: bert-score==0.3.5 in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 12)) (0.3.5)
Requirement already satisfied: flask in /root/miniconda3/lib/python3.9/site-packages (from -r requirements/requirements_model.txt (line 13)) (2.0.2)
Requirement already satisfied: requests in /root/miniconda3/lib/python3.9/site-packages (from bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (2.25.1)
Requirement already satisfied: torch>=1.0.0 in /root/miniconda3/lib/python3.9/site-packages (from bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (1.9.0)
Requirement already satisfied: tqdm>=4.31.1 in /root/miniconda3/lib/python3.9/site-packages (from bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (4.62.2)
Requirement already satisfied: matplotlib in /root/miniconda3/lib/python3.9/site-packages (from bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (3.4.3)
Requirement already satisfied: pandas>=1.0.1 in /root/miniconda3/lib/python3.9/site-packages (from bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (1.3.3)
Requirement already satisfied: filelock in /root/miniconda3/lib/python3.9/site-packages (from transformers->-r requirements/requirements_model.txt (line 2)) (3.3.2)
Requirement already satisfied: packaging in /root/miniconda3/lib/python3.9/site-packages (from transformers->-r requirements/requirements_model.txt (line 2)) (21.0)
Requirement already satisfied: pyyaml>=5.1 in /root/miniconda3/lib/python3.9/site-packages (from transformers->-r requirements/requirements_model.txt (line 2)) (5.4.1)
Requirement already satisfied: tokenizers<0.11,>=0.10.1 in /root/miniconda3/lib/python3.9/site-packages (from transformers->-r requirements/requirements_model.txt (line 2)) (0.10.3)
Requirement already satisfied: regex!=2019.12.17 in /root/miniconda3/lib/python3.9/site-packages (from transformers->-r requirements/requirements_model.txt (line 2)) (2021.8.28)
Requirement already satisfied: huggingface-hub>=0.0.12 in /root/miniconda3/lib/python3.9/site-packages (from transformers->-r requirements/requirements_model.txt (line 2)) (0.0.17)
Requirement already satisfied: sacremoses in /root/miniconda3/lib/python3.9/site-packages (from transformers->-r requirements/requirements_model.txt (line 2)) (0.0.45)
Requirement already satisfied: typing-extensions in /root/.local/lib/python3.9/site-packages (from huggingface-hub>=0.0.12->transformers->-r requirements/requirements_model.txt (line 2)) (3.7.4.3)
Requirement already satisfied: pyparsing>=2.0.2 in /root/miniconda3/lib/python3.9/site-packages (from packaging->transformers->-r requirements/requirements_model.txt (line 2)) (2.4.7)
Requirement already satisfied: python-dateutil>=2.7.3 in /root/miniconda3/lib/python3.9/site-packages (from pandas>=1.0.1->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (2.8.2)
Requirement already satisfied: pytz>=2017.3 in /root/miniconda3/lib/python3.9/site-packages (from pandas>=1.0.1->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (2021.1)
Requirement already satisfied: six>=1.5 in /root/.local/lib/python3.9/site-packages (from python-dateutil>=2.7.3->pandas>=1.0.1->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (1.15.0)
Requirement already satisfied: pyarrow!=4.0.0,>=1.0.0 in /root/miniconda3/lib/python3.9/site-packages (from datasets->-r requirements/requirements_model.txt (line 4)) (5.0.0)
Requirement already satisfied: xxhash in /root/miniconda3/lib/python3.9/site-packages (from datasets->-r requirements/requirements_model.txt (line 4)) (2.0.2)
Requirement already satisfied: fsspec[http]>=2021.05.0 in /root/miniconda3/lib/python3.9/site-packages (from datasets->-r requirements/requirements_model.txt (line 4)) (2021.8.1)
Requirement already satisfied: multiprocess in /root/miniconda3/lib/python3.9/site-packages (from datasets->-r requirements/requirements_model.txt (line 4)) (0.70.12.2)
Requirement already satisfied: aiohttp in /root/miniconda3/lib/python3.9/site-packages (from datasets->-r requirements/requirements_model.txt (line 4)) (3.6.2)
Requirement already satisfied: dill in /root/miniconda3/lib/python3.9/site-packages (from datasets->-r requirements/requirements_model.txt (line 4)) (0.3.4)
Requirement already satisfied: idna<3,>=2.5 in /root/miniconda3/lib/python3.9/site-packages (from requests->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (2.10)
Requirement already satisfied: chardet<5,>=3.0.2 in /root/miniconda3/lib/python3.9/site-packages (from requests->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (3.0.4)
Requirement already satisfied: certifi>=2017.4.17 in /root/miniconda3/lib/python3.9/site-packages (from requests->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (2021.10.8)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /root/miniconda3/lib/python3.9/site-packages (from requests->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (1.26.6)
Requirement already satisfied: scipy>=1.1.0 in /root/miniconda3/lib/python3.9/site-packages (from scikit-learn->-r requirements/requirements_model.txt (line 5)) (1.7.1)
Requirement already satisfied: joblib>=0.11 in /root/miniconda3/lib/python3.9/site-packages (from scikit-learn->-r requirements/requirements_model.txt (line 5)) (1.0.1)
Requirement already satisfied: threadpoolctl>=2.0.0 in /root/miniconda3/lib/python3.9/site-packages (from scikit-learn->-r requirements/requirements_model.txt (line 5)) (3.0.0)
Requirement already satisfied: botocore<1.24.0,>=1.23.5 in /root/miniconda3/lib/python3.9/site-packages (from boto3->-r requirements/requirements_model.txt (line 6)) (1.23.5)
Requirement already satisfied: s3transfer<0.6.0,>=0.5.0 in /root/miniconda3/lib/python3.9/site-packages (from boto3->-r requirements/requirements_model.txt (line 6)) (0.5.0)
Requirement already satisfied: jmespath<1.0.0,>=0.7.1 in /root/miniconda3/lib/python3.9/site-packages (from boto3->-r requirements/requirements_model.txt (line 6)) (0.10.0)
Requirement already satisfied: click in /root/miniconda3/lib/python3.9/site-packages (from nltk->-r requirements/requirements_model.txt (line 8)) (8.0.1)
Requirement already satisfied: Jinja2>=3.0 in /root/miniconda3/lib/python3.9/site-packages (from flask->-r requirements/requirements_model.txt (line 13)) (3.0.3)
Requirement already satisfied: Werkzeug>=2.0 in /root/.local/lib/python3.9/site-packages (from flask->-r requirements/requirements_model.txt (line 13)) (2.0.1)
Requirement already satisfied: itsdangerous>=2.0 in /root/miniconda3/lib/python3.9/site-packages (from flask->-r requirements/requirements_model.txt (line 13)) (2.0.1)
Requirement already satisfied: MarkupSafe>=2.0 in /root/miniconda3/lib/python3.9/site-packages (from Jinja2>=3.0->flask->-r requirements/requirements_model.txt (line 13)) (2.0.1)
Requirement already satisfied: async-timeout<4.0,>=3.0 in /root/miniconda3/lib/python3.9/site-packages (from aiohttp->datasets->-r requirements/requirements_model.txt (line 4)) (3.0.1)
Requirement already satisfied: attrs>=17.3.0 in /root/miniconda3/lib/python3.9/site-packages (from aiohttp->datasets->-r requirements/requirements_model.txt (line 4)) (19.3.0)
Requirement already satisfied: multidict<5.0,>=4.5 in /root/miniconda3/lib/python3.9/site-packages (from aiohttp->datasets->-r requirements/requirements_model.txt (line 4)) (4.7.6)
Requirement already satisfied: yarl<2.0,>=1.0 in /root/miniconda3/lib/python3.9/site-packages (from aiohttp->datasets->-r requirements/requirements_model.txt (line 4)) (1.6.3)
Requirement already satisfied: cycler>=0.10 in /root/miniconda3/lib/python3.9/site-packages (from matplotlib->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (0.10.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /root/miniconda3/lib/python3.9/site-packages (from matplotlib->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (1.3.2)
Requirement already satisfied: pillow>=6.2.0 in /root/miniconda3/lib/python3.9/site-packages (from matplotlib->bert-score==0.3.5->-r requirements/requirements_model.txt (line 12)) (8.4.0)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
fatal: destination path 'opus-mt-de-en' already exists and is not an empty directory.
2022-03-15 13:30:02.460653: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2022-03-15 13:30:02.460740: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
mkdir: cannot create directory ‘my-tokenizer’: File exists
sentencepiece_trainer.cc(177) LOG(INFO) Running command: --input=train/train.my --model_prefix=my-tokenizer/spm --vocab_size=50000 --character_coverage=1.0 --hard_vocab_limit=false
sentencepiece_trainer.cc(77) LOG(INFO) Starts training with : 
trainer_spec {
  input: train/train.my
  input_format: 
  model_prefix: my-tokenizer/spm
  model_type: UNIGRAM
  vocab_size: 50000
  self_test_sample_size: 0
  character_coverage: 1
  input_sentence_size: 0
  shuffle_input_sentence: 1
  seed_sentencepiece_size: 1000000
  shrinking_factor: 0.75
  max_sentence_length: 4192
  num_threads: 16
  num_sub_iterations: 2
  max_sentencepiece_length: 16
  split_by_unicode_script: 1
  split_by_number: 1
  split_by_whitespace: 1
  split_digits: 0
  treat_whitespace_as_suffix: 0
  allow_whitespace_only_pieces: 0
  required_chars: 
  byte_fallback: 0
  vocabulary_output_piece_score: 1
  train_extremely_large_corpus: 0
  hard_vocab_limit: 0
  use_all_vocab: 0
  unk_id: 0
  bos_id: 1
  eos_id: 2
  pad_id: -1
  unk_piece: <unk>
  bos_piece: <s>
  eos_piece: </s>
  pad_piece: <pad>
  unk_surface:  ⁇ 
}
normalizer_spec {
  name: nmt_nfkc
  add_dummy_prefix: 1
  remove_extra_whitespaces: 1
  escape_whitespaces: 1
  normalization_rule_tsv: 
}
denormalizer_spec {}
trainer_interface.cc(329) LOG(INFO) SentenceIterator is not specified. Using MultiFileSentenceIterator.
trainer_interface.cc(178) LOG(INFO) Loading corpus: train/train.my
trainer_interface.cc(356) LOG(WARNING) Found too long line (4419 > 4192).
trainer_interface.cc(358) LOG(WARNING) Too long lines are skipped in the training.
trainer_interface.cc(359) LOG(WARNING) The maximum length can be changed with --max_sentence_length=<size> flag.
trainer_interface.cc(385) LOG(INFO) Loaded all 876904 sentences
trainer_interface.cc(391) LOG(INFO) Skipped 1080 too long sentences.
trainer_interface.cc(400) LOG(INFO) Adding meta_piece: <unk>
trainer_interface.cc(400) LOG(INFO) Adding meta_piece: <s>
trainer_interface.cc(400) LOG(INFO) Adding meta_piece: </s>
trainer_interface.cc(405) LOG(INFO) Normalizing sentences...
trainer_interface.cc(466) LOG(INFO) all chars count=93426324
trainer_interface.cc(477) LOG(INFO) Done: 100% characters are covered.
trainer_interface.cc(487) LOG(INFO) Alphabet size=3179
trainer_interface.cc(488) LOG(INFO) Final character coverage=1
trainer_interface.cc(520) LOG(INFO) Done! preprocessed 876286 sentences.
unigram_model_trainer.cc(139) LOG(INFO) Making suffix array...
unigram_model_trainer.cc(143) LOG(INFO) Extracting frequent sub strings...
unigram_model_trainer.cc(194) LOG(INFO) Initialized 1000000 seed sentencepieces
trainer_interface.cc(526) LOG(INFO) Tokenizing input sentences with whitespace: 876286
trainer_interface.cc(537) LOG(INFO) Done! 2439564
unigram_model_trainer.cc(489) LOG(INFO) Using 2439564 sentences for EM training
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=484060 obj=25.0097 num_tokens=8534008 num_tokens/piece=17.6301
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=327867 obj=20.2841 num_tokens=8584425 num_tokens/piece=26.1826
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=245033 obj=20.0819 num_tokens=8658931 num_tokens/piece=35.3378
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=240007 obj=20.0065 num_tokens=8684054 num_tokens/piece=36.1825
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=179889 obj=20.0331 num_tokens=8775886 num_tokens/piece=48.785
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=179757 obj=20.0056 num_tokens=8783721 num_tokens/piece=48.8644
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=134794 obj=20.1172 num_tokens=8943613 num_tokens/piece=66.3502
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=134754 obj=20.0764 num_tokens=8947331 num_tokens/piece=66.3975
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=101058 obj=20.2942 num_tokens=9170415 num_tokens/piece=90.7441
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=101045 obj=20.222 num_tokens=9172776 num_tokens/piece=90.7791
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=75782 obj=20.5245 num_tokens=9428479 num_tokens/piece=124.416
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=75779 obj=20.4356 num_tokens=9429612 num_tokens/piece=124.436
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=56833 obj=20.8126 num_tokens=9716959 num_tokens/piece=170.974
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=56832 obj=20.7125 num_tokens=9718274 num_tokens/piece=171
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=0 size=54999 obj=20.7527 num_tokens=9752324 num_tokens/piece=177.318
unigram_model_trainer.cc(505) LOG(INFO) EM sub_iter=1 size=54999 obj=20.7407 num_tokens=9754022 num_tokens/piece=177.349
trainer_interface.cc(615) LOG(INFO) Saving model: my-tokenizer/spm.model
trainer_interface.cc(626) LOG(INFO) Saving vocabs: my-tokenizer/spm.vocab
train/train.my
